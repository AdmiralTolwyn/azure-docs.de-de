---
title: SQL-Sicherheitsrisikobewertung
description: Erfahren Sie, wie Sie die SQL-Sicherheitsrisikobewertung in SQL-Datenbank konfigurieren und die Bewertungsberichte interpretieren.
services: sql-database
ms.service: sql-database
ms.subservice: security
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: mibar
ms.author: mibar
ms.reviewer: vanto, carlrab
ms.date: 02/05/2020
tags: azure-synapse
ms.openlocfilehash: 87f3c4b0489c48f758ce9e660bdfd599c086b677
ms.sourcegitcommit: 225a0b8a186687154c238305607192b75f1a8163
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 02/29/2020
ms.locfileid: "78191978"
---
# <a name="sql-vulnerability-assessment-service-helps-you-identify-database-vulnerabilities"></a>Mit dem Dienst zur SQL-Sicherheitsrisikobewertung können Sie Datenbankschwachstellen erkennen.

Die SQL-Sicherheitsrisikobewertung ist ein einfach zu konfigurierender Dienst, mit dem potenzielle Schwachstellen in der Datenbank ermittelt, nachverfolgt und behoben werden können. Verwenden Sie es zur proaktiven Verbesserung Ihrer Datenbanksicherheit.

Die Sicherheitsrisikobewertung ist Bestandteil des Angebots [Advanced Data Security](sql-database-advanced-data-security.md) (ADS). Dabei handelt es sich um ein vereinheitlichtes Paket für erweiterte SQL-Sicherheitsfunktionen. Der Zugriff auf die Sicherheitsrisikobewertung und ihre Verwaltung sind über das zentrale SQL ADS-Portal möglich.

> [!NOTE]
> Die Sicherheitsrisikobewertung wird für Azure SQL-Datenbank, verwaltete Azure SQL-Datenbank-Instanz und Azure Synapse Analytics unterstützt. Der Einfachheit halber wird in diesem Artikel der Begriff „SQL-Datenbank“ verwendet, wenn auf einen dieser verwalteten Datenbankdienste Bezug genommen wird.

## <a name="the-vulnerability-assessment-service"></a>Dienst zur Sicherheitsrisikobewertung

Die SQL-Sicherheitsrisikobewertung ist ein Dienst, der Einblicke in Ihren Sicherheitsstatus bietet, umsetzbare Schritte zum Beheben von Sicherheitsproblemen enthält und Ihre Datenbanksicherheit verbessert. Sie kann Ihnen die Durchführung folgender Aufgaben erleichtern:  

- Erfüllen der Konformitätsanforderungen, die Datenbanküberprüfungs-Berichte erfordern.  
- Einhalten von Datenschutzstandards.  
- Überwachen einer dynamischen Datenbankumgebung, in der Änderungen schwer zu verfolgen sind.  

Die Sicherheitsrisikobewertung ist ein Überprüfungsdienst, der in den Azure SQL-Datenbank-Dienst integriert ist. Der Dienst wendet eine Wissensdatenbank mit Regeln an, die Sicherheitsrisiken kennzeichnen und Abweichungen von bewährten Methoden wie Fehlkonfigurationen, übermäßige Berechtigungen und ungeschützte sensible Daten hervorheben. Die Regeln basieren auf bewährten Methoden von Microsoft und konzentrieren sich auf die Sicherheitsprobleme, die das größte Risiko für Ihre Datenbank und deren wertvolle Daten darstellt. Sie betreffen sowohl Probleme auf Datenbankebene als auch Sicherheitsprobleme auf Serverebene wie Server-Firewalleinstellungen und Berechtigungen auf Serverebene. Diese Regeln spiegeln darüber hinaus viele Anforderungen verschiedener Aufsichtsbehörden wider, um deren Konformitätsstandards zu erfüllen.  

Zu den Ergebnissen der Überprüfung zählen Aktionsschritte zum Beheben der jeweiligen Probleme und ggf. das Bereitstellen benutzerdefinierter Skripts zur Wiederherstellung. Ein Bewertungsbericht kann für Ihre Umgebung angepasst werden, indem eine akzeptable Baseline für Berechtigungskonfigurationen, Featurekonfigurationen und Datenbankeinstellungen festgelegt wird.

## <a name="implementing-vulnerability-assessment"></a>Implementieren der Sicherheitsrisikobewertung

Die folgenden Schritte implementieren die Sicherheitsrisikobewertung in SQL-Datenbank.  

### <a name="1-run-a-scan"></a>1. Ausführen einer Überprüfung  

Aktivieren Sie die Sicherheitsrisikobewertung, indem Sie im Azure SQL-Datenbank-Bereich unter der Überschrift „Sicherheit“ zu **Advanced Data Security** navigieren. Aktivieren Sie Advanced Data Security durch Klicken, und klicken Sie dann auf **Speicher auswählen** oder auf die Karte **Sicherheitsrisikobewertung**. Dadurch wird die Karte „Einstellungen für Sicherheitsrisikobewertung“ für den gesamten SQL-Server automatisch geöffnet.

Konfigurieren Sie zunächst ein Speicherkonto, in dem Ihre Überprüfungsergebnisse für alle Datenbanken auf dem Server gespeichert werden. Weitere Informationen zu Speicherkonten finden Sie unter [Informationen zu Azure-Speicherkonten](../storage/common/storage-create-storage-account.md). Sobald der Speicher konfiguriert ist, klicken Sie auf **Überprüfen**, um Ihre Datenbank auf Sicherheitsrisiken zu überprüfen.
  
![Überprüfen einer Datenbank](./media/sql-vulnerability-assessment/pp_va_initialize.png)  

  > [!NOTE]
  > Die Überprüfung belastet die Ressourcen nicht und ist sicher. Sie dauert ein paar Sekunden und ist vollständig schreibgeschützt. Es werden keine Änderungen an Ihrer Datenbank vorgenommen.  

### <a name="2-view-the-report"></a>2. Anzeigen des Berichts

Wenn die Überprüfung abgeschlossen ist, wird Ihr Überprüfungsbericht automatisch im Azure-Portal angezeigt. Der Bericht bietet eine Übersicht über Ihren Sicherheitsstatus, wie viele Probleme gefunden wurden und deren jeweiligen Schweregrad. Die Ergebnisse schließen Warnungen zu Abweichungen von bewährten Methoden sowie eine Momentaufnahme Ihrer sicherheitsbezogenen Einstellungen ein, z.B. Datenbankprinzipale und Rollen mit ihren zugehörigen Berechtigungen. Der Überprüfungsbericht bietet außerdem eine Übersicht über erkannte sensible Daten in Ihrer Datenbank und Empfehlungen zur Klassifizierung dieser Daten mithilfe von [Datenermittlung und -klassifizierung](sql-database-data-discovery-and-classification.md).

![Anzeigen des Berichts](./media/sql-vulnerability-assessment/pp_main_getstarted.png)  

### <a name="3-analyze-the-results-and-resolve-issues"></a>3. Analysieren der Ergebnisse und Beheben der Probleme

Überprüfen Sie Ihre Ergebnisse, und ermitteln Sie, bei welchen Ergebnissen im Bericht es sich um tatsächliche Sicherheitsprobleme in Ihrer Umgebung handelt. Führen Sie einen Drilldown für jedes fehlerhafte Ergebnis aus, um die Auswirkung des Ergebnisses und die Gründe für die Fehler bei den Sicherheitsüberprüfungen nachvollziehen zu können. Nutzen Sie die Informationen des Berichts zu Wiederherstellungsaktionen, um das Problem zu beheben.  

![Analysieren des Berichts](./media/sql-vulnerability-assessment/pp_fail_rule_show_remediation.png)

### <a name="4-set-your-baseline"></a>4. Festlegen Ihrer Baseline

Wenn Sie Ihre Bewertungsergebnisse überprüfen, können Sie bestimmte Ergebnisse als akzeptable *Baseline* für Ihre Umgebung markieren. Die Baseline ist im Wesentlichen eine Anpassung der Art, in der die Ergebnisse berichtet werden. Wenn Ergebnisse in nachfolgenden Überprüfungen mit der Baseline übereinstimmen, wird dies als Bestehen gewertet. Sobald Sie den Sicherheitsstatus Ihrer Baseline festgelegt haben, berichtet die Sicherheitsrisikobewertung nur über Abweichungen von der Baseline, und Sie können sich auf die relevanten Probleme konzentrieren.  

![Festlegen Ihrer Baseline](./media/sql-vulnerability-assessment/pp_fail_rule_show_baseline.png)  

### <a name="5-run-a-new-scan-to-see-your-customized-tracking-report"></a>5. Ausführen einer neuen Überprüfung zum Anzeigen Ihres benutzerdefinierten Nachverfolgungsberichts

Nachdem Sie die Einrichtung der **Baselines für Ihre Regeln** abgeschlossen haben, führen Sie eine neue Überprüfung aus, um den benutzerdefinierten Bericht anzuzeigen. Die Sicherheitsrisikobewertung meldet nun nur die Sicherheitsprobleme, die von Ihrem genehmigten Baselinestatus abweichen.

![Anzeige des benutzerdefinierten Berichts](./media/sql-vulnerability-assessment/pp_pass_main_with_baselines.png)  

Die Sicherheitsrisikobewertung kann nun verwendet werden, um zu überwachen, dass Ihre Datenbank jederzeit über ein hohes Maß an Sicherheit verfügt und dass die Organisationsrichtlinien erfüllt werden. Wenn Konformitätsberichte erforderlich sind, können VA-Berichte hilfreich sein, um den Konformitätsprozess zu vereinfachen.  

### <a name="6-set-up-periodic-recurring-scans"></a>6. Einrichten von regelmäßig wiederkehrenden Überprüfungen

Navigieren Sie zu den Einstellungen der Sicherheitsrisikobewertung, um **Regelmäßig wiederkehrende Überprüfungen** zu aktivieren. Dadurch wird die Sicherheitsrisikobewertung dafür konfiguriert, automatisch einmal pro Woche eine Überprüfung der Datenbank auszuführen. Eine Zusammenfassung der Scanergebnisse wird an die angegebenen E-Mail-Adressen gesendet.

![Anzeige des benutzerdefinierten Berichts](./media/sql-vulnerability-assessment/pp_recurring_scans.png)

### <a name="7-export-an-assessment-report"></a>7. Exportieren eines Bewertungsberichts

Klicken Sie auf **Überprüfungsergebnisse exportieren**, um einen herunterladbaren Excel-Bericht der Überprüfungsergebnisse zu erstellen. Dieser Bericht enthält eine Registerkarte, die eine Zusammenfassung der Bewertung enthält, einschließlich aller fehlerhaften Überprüfungen. Er enthält auch eine Registerkarte **Ergebnisse** mit den vollständigen Ergebnissen der Überprüfung, einschließlich aller Überprüfungen, die ausgeführt wurden, und der jeweiligen Ergebnisdetails.

### <a name="8-view-scan-history"></a>8. Anzeigen des Überprüfungsverlaufs

Klicken Sie auf **Überprüfungsverlauf** im Bereich der Sicherheitsrisikobewertung, um einen Verlauf aller zuvor für diese Datenbank ausgeführten Überprüfungen anzuzeigen. Wählen Sie eine bestimmte Überprüfung in der Liste aus, um die ausführlichen Ergebnisse dieser Überprüfung anzuzeigen.

Die Sicherheitsrisikobewertung kann nun verwendet werden, um zu überwachen, dass Ihre Datenbank jederzeit über ein hohes Maß an Sicherheit verfügt und dass die Organisationsrichtlinien erfüllt werden. Wenn Konformitätsberichte erforderlich sind, können VA-Berichte hilfreich sein, um den Konformitätsprozess zu vereinfachen.

## <a name="manage-vulnerability-assessments-using-azure-powershell"></a>Verwalten der Sicherheitsrisikobewertungen mithilfe von Azure PowerShell

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]
> [!IMPORTANT]
> Das PowerShell Azure Resource Manager-Modul wird von Azure SQL-Datenbank weiterhin unterstützt, aber alle zukünftigen Entwicklungen erfolgen für das Az.Sql-Modul. Informationen zu diesen Cmdlets finden Sie unter [AzureRM.Sql](https://docs.microsoft.com/powershell/module/AzureRM.Sql/). Die Argumente für die Befehle im Az-Modul und den AzureRm-Modulen sind im Wesentlichen identisch.

Sie können die Azure PowerShell-Cmdlets verwenden, um Ihre Sicherheitsrisikobewertungen programmgesteuert zu verwalten. Die unterstützten Cmdlets sind die folgenden:

- [Update-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting)

  Aktualisiert die Einstellungen für die Sicherheitsrisikobewertung einer Datenbank.
- [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting)

  Gibt die Einstellungen für die Sicherheitsrisikobewertung einer Datenbank zurück.
- [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting)

  Löscht die Einstellungen für die Sicherheitsrisikobewertung einer Datenbank.
- [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline)

  Legt die Baseline für die Regel zur Sicherheitsrisikobewertung fest.
- [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline)

  Ruft die Baseline für die Regel zur Sicherheitsrisikobewertung für eine angegebene Regel ab.
- [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline)

  Löscht die Baseline für die Regel zur Sicherheitsrisikobewertung. Legen Sie zunächst die Baseline fest, bevor Sie das Cmdlet zum Löschen verwenden.
- [Start-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan)

  Löst den Start einer Sicherheitsrisikobewertungsüberprüfung aus.
- [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord)

   Ruft alle Überprüfungsdatensätze für die Sicherheitsrisikobewertung ab, die einer angegebenen Datenbank zugeordnet sind.
- [Convert-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan)

  Konvertiert die Überprüfungsergebnisse der Sicherheitsrisikobewertung in eine Excel-Datei.

Ein Skriptbeispiel finden Sie im Blogbeitrag [Azure SQL Vulnerability Assessment PowerShell support (SQL-Sicherheitsrisikobewertung: Unterstützung für PowerShell)](https://blogs.msdn.microsoft.com/sqlsecurity/20../../azure-sql-vulnerability-assessment-now-with-powershell-support/).

## <a name="manage-vulnerability-assessments-baseline-rules-using-resource-manager-templates"></a>Verwalten von Baselineregeln der Sicherheitsrisikobewertungen mit Resource Manager-Vorlagen

Wenn Sie mithilfe von Azure Resource Manager-Vorlagen Baselines für Sicherheitsrisikobewertungen konfigurieren, müssen Sie den `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines`-Typ verwenden.

Stellen Sie sicher, dass Sie auf dem Computer, auf dem SQL Server ausgeführt wird, „vulnerabilityAssements“ aktiviert haben, bevor Sie Baselines hinzufügen.

Hier ist ein Beispiel zum Definieren der Baselineregel VA2065 in der Masterdatenbank und VA1143 in der Benutzerdatenbank als Ressourcen in einer Resource Manager-Vorlage:

```json
    "resources": [
        {
            "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
            "apiVersion": "2018-06-01-preview",
            "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
            "properties": {
                "baselineResults": [
                    {
                        "result": [
                                "FirewallRuleName3",
                                "StartIpAddress",
                                "EndIpAddress"
                                  ]
                    },{
                         "result": [
                                "FirewallRuleName4",
                                "62.92.15.68",
                                "62.92.15.68"
                            ]
                        
                    }
                ]
            },
        {
            "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
            "apiVersion": "2018-06-01-preview",
            "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
            "dependsOn": [
                "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
            ],
            "properties": {
                "baselineResults": [
                    {
                        "result": [
                            "dbo"
                        ]
                    }
                ]
            }
        }
    ]
}   
```

Für die Benutzerdatenbank und die Masterdatenbank werden die Ressourcennamen unterschiedlich definiert:

* Masterdatenbank: "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>master</b>')]",
* Benutzerdatenbank: "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>default</b>')]",
 
 
 Um <b>boolesche</b> Typen als „true/false“ (wahr/falsch) zu behandeln, stellen Sie das Baselineergebnis mit binärer Eingabe wie "1"/"0" ein.
 
 ```json
        {
            "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
            "apiVersion": "2018-06-01-preview",
            "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",
            "dependsOn": [
                "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
            ],
            "properties": {
                "baselineResults": [
                    {
                        "result": [
                            "1"
                        ]
                    }
                ]
            }
        }
    ]
}   
```
 
 
## <a name="next-steps"></a>Nächste Schritte  

- Erfahren Sie mehr über [Advanced Data Security](sql-database-advanced-data-security.md)
- Weitere Informationen zur [Datenermittlung und -klassifizierung](sql-database-data-discovery-and-classification.md)
